install:
- nvm install && nvm use
- npm install -g "npm@$(jq -r '.engines.npm' package.json)"
- npm ci
matrix:
  include:
  - os: linux
    language: android
    jdk: oraclejdk8
    android:
      components:
        - build-tools-29.0.2
        - android-29
    before_install:
      - yes | sdkmanager "platforms;android-29"
      - yes | sdkmanager "build-tools;29.0.2"
    script:
      - "./android/gradlew assembleRelease -p android/"
  - os: osx
    osx_image: xcode9.3
    before_install:
      - brew install jq
      - bundle install
    script:
      - bundle exec fastlane ios test